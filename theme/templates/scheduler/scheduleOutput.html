{% extends 'base.html' %}
{% block content %}
<div class="max-w-7xl mx-auto p-6 space-y-6">
  <h1 class="text-3xl font-bold text-gray-800">Scheduler Output</h1>

  <!-- 🔍 Filter Form -->
  <form method="get" class="bg-white rounded-xl shadow p-5 border border-gray-100">
    <div class="grid md:grid-cols-4 gap-4">
      <!-- Semester -->
        <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Semester</label>
        <select name="semester" class="w-full border border-gray-300 rounded-lg p-2 focus:ring-2 focus:ring-indigo-500">
            <option value="">All Semesters</option>
            {% for sem in semesters %}
            <option value="{{ sem.semesterId }}" {% if selected_semester == sem.semesterId|stringformat:"s" %}selected{% endif %}>
                {{ sem.name }}
            </option>
            {% endfor %}
        </select>
        </div>

      <!-- Instructor -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Instructor</label>
        <select name="instructor" class="w-full border border-gray-300 rounded-lg p-2 focus:ring-2 focus:ring-indigo-500">
          <option value="">All Instructors</option>
          {% for instr in instructors %}
            <option value="{{ instr.instructorId }}" {% if selected_instructor == instr.instructorId|stringformat:"s" %}selected{% endif %}>
              {{ instr.full_name }}
            </option>
          {% endfor %}
        </select>
      </div>

      <!-- Day of Week -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Day</label>
        <select name="day" class="w-full border border-gray-300 rounded-lg p-2 focus:ring-2 focus:ring-indigo-500">
          <option value="">All Days</option>
          {% for d in days %}
            <option value="{{ d }}" {% if selected_day == d %}selected{% endif %}>{{ d }}</option>
          {% endfor %}
        </select>
      </div>

      <!-- Apply Button -->
      <div class="flex items-end">
        <button type="submit"
                class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-medium rounded-lg px-4 py-2 transition">
          Apply Filters
        </button>
      </div>
    </div>
  </form>

  <!-- 📋 Schedule Table -->
  {% if schedules %}
  <div class="overflow-x-auto bg-white rounded-2xl shadow border border-gray-100">
    <table class="min-w-full text-sm text-left text-gray-600">
      <thead class="bg-indigo-600 text-white text-xs uppercase tracking-wider">
        <tr>
          <th class="px-6 py-3">Subject</th>
          <th class="px-6 py-3">Instructor</th>
          <th class="px-6 py-3">Section</th>
          <th class="px-6 py-3">Room</th>
          <th class="px-6 py-3">Semester</th>
          <th class="px-6 py-3">Day</th>
          <th class="px-6 py-3">Time</th>
          <th class="px-6 py-3">Type</th>
          <th class="px-6 py-3">Overtime?</th>
        </tr>
      </thead>
      <tbody>
        {% for sched in schedules %}
        <tr class="border-b hover:bg-gray-50 transition">
          <td class="px-6 py-3 font-medium text-gray-800">
            {{ sched.subject.code }} - {{ sched.subject.name }}
          </td>
          <td class="px-6 py-3">{{ sched.instructor.full_name }}</td>
          <td class="px-6 py-3">{{ sched.section.sectionCode }}</td>
          <td class="px-6 py-3">{{ sched.room.name|default:"—" }}</td>
          <td class="px-6 py-3">{{ sched.semester.name }}</td>
          <td class="px-6 py-3">{{ sched.dayOfWeek }}</td>
          <td class="px-6 py-3">
            {{ sched.startTime|time:"h:i A" }} – {{ sched.endTime|time:"h:i A" }}
          </td>
          <td class="px-6 py-3 capitalize">{{ sched.scheduleType }}</td>
          <td class="px-6 py-3">
            {% if sched.isOvertime %}
              <span class="text-red-600 font-semibold">Yes</span>
            {% else %}
              <span class="text-green-600 font-medium">No</span>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
  <p class="text-gray-500 text-center mt-10">No schedules found for the selected filters.</p>
  {% endif %}
</div>
{% endblock %}
